name: Update Dev and Staging branches

on:
  push:
    branches: [ main ]

jobs:
  updateBranches:
    name: Update branches
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
        with:
          ref: staging
      - name: Update staging
        run: |
          git pull -r origin main
          git push -f origin staging

      - uses: actions/checkout@v2
        with:
          ref: main
      - name: Reset dev
        run: |
          git push origin :dev
          git checkout -b dev
          git push origin dev